<script>

//=================================================================
//  Do not customize this block. It will be overwritten.
//=================================================================

////////////////////////////////////////////////////
//  TD1OnBlur
////////////////////////////////////////////////////
function TD1OnBlur(el){
    return eFormRunValidator('OnBlurTD1',el);
}

////////////////////////////////////////////////////
//  TD1OnFocus
////////////////////////////////////////////////////
function TD1OnFocus(el){
    return eFormRunValidator('OnFocusTD1',el);
}

////////////////////////////////////////////////////
//  TD1OnChange
////////////////////////////////////////////////////
function TD1OnChange(el){
  // SERVICES-38314 | Personal Tax Credits Return - TD1 - Form Error 
  if (el.getAttribute('id') === 'employer') {
   toggleClaims(el);
  }
  calcTotal();
  return eFormRunValidator('OnChangeTD1',el);
}

////////////////////////////////////////////////////
//  TD1OnClick
////////////////////////////////////////////////////
function TD1OnClick(el){
    return eFormRunValidator('OnClickTD1',el);
}

////////////////////////////////////////////////////
//  OnFocusTD1Signature
////////////////////////////////////////////////////
function OnFocusTD1Signature(el){
    return openESig('modal','over',this);    
}

////////////////////////////////////////////////////
//  OnChangeTD1Signature
////////////////////////////////////////////////////
function OnChangeTD1Signature(el){
    return signatureVerification('sv');    
}

////////////////////////////////////////////////////
//  OnLoadPersonal_Tax_Credits_Return_TD1
////////////////////////////////////////////////////
function OnLoadPersonal_Tax_Credits_Return_TD1(){
    readOnlySig('signature');
    calcTotal();
}

////////////////////////////////////////////////////
//  calcTotal
////////////////////////////////////////////////////

function calcTotal()
{
   dblTotal = 0.0
   for (i=1;i<=12;i++)
   {
       el = document.getElementById('q'+i);
       strVal = el.value;
       strVal = strVal.replace("$","");
       strVal = strVal.replace(",","");
       dblVal = parseFloat(strVal)

       if (strVal != "")
       {
            if (strVal == dblVal)
            {
                 dblTotal += dblVal;
            } else {
                 el.focus();
                 alert("Error in validation, value must be in a valid currency format.");   
                 el.value = "";
               }
       }
       if (!document.getElementById('employer').checked) {
         document.getElementById('total').value = dblTotal.toFixed(2);
       }
          
   }

}
function toggleClaims(el) {
  let qs = document.querySelectorAll('#q2,#q3,#q4,#q5,#q6,#q7,#q8,#q9,#q10,#q11,#q12');
  if (el.checked === true) {
    for (let i=0;i<qs.length;i++) {
      qs[i].value='';
      qs[i].readOnly=true;
    }
    document.querySelector('#total').value=0;
    document.querySelector('#total').readOnly = false;
    return;
  }
  for (let j=0;j<qs.length;j++) {
    qs[j].readOnly=false;
  }
  document.querySelectorAll('#total').readOnly = true;
}
$(window).on('load', function() {
    toggleClaims(document.querySelector('#employer'));
});
</script>
